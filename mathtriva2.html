<!DOCTYPE html>
<html lang="en">
    <head>

        <meta charset="UTF-8">
        <title>Math with Friends</title>

        <!-- Added a link to Bootstrap-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="assets/css/reset.css">
       <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
       <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">

       <!-- Firebase Reference -->
        <script src="https://www.gstatic.com/firebasejs/3.6.4/firebase.js"></script>

       <script type="text/javascript" async
            src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=AM_CHTML"></script>
        <!-- <link rel="stylesheet" type="text/css" href="assets/css/style.css"> -->

        <style type="text/css">
        /*CSS stye goes here*/
            h1 {
            	font-size: 30px
            }

            p {
            	font-size: 24px;
            }

            #problems {
                font-size: 24px;
            }

        </style>

    </head>
<body>
    
      <div id="wrapper">
        <h1>Math with Friend Trivia</h1>
        <div id="subwrapper">
        <button id="start">Start</button>
            </div>
    </div>


<!-- Added link to the jQuery Library --> 
<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.js"></script>
	<script type="text/javascript">
    // <script type="text/javascript" src="assets/javascript/app.js">

// As system, it will generate a math problem and present to both users
// Javascript and jQuery goes here

// Initialize Firebase
  var config = {
    apiKey: "AIzaSyAvn7BoFuTiM_rbCf5x0IZk7asIcsJl_XE",
    authDomain: "ghostbusterproject1.firebaseapp.com",
    databaseURL: "https://ghostbusterproject1.firebaseio.com",
    storageBucket: "ghostbusterproject1.appspot.com",
    messagingSenderId: "519386657422"
  };
  
  firebase.initializeApp(config);

  var database = firebase.database();


$('#start').on('click', function(){
    $('#start').remove();
    game.loadQuestion();
});

var userAnswer;
var numberAnswer;
$(document).on('click', '#submitAnswer', function(e){
    game.clicked(e);
    userAnswer = $('#userAnswer').val().trim();
    numberAnswer = parseInt(userAnswer)
})

$(document).on('click', '#reset', function(){
    game.reset();
})

var questions = [{
        question: "(8 - 1) + x = 3 + (4 + 5)",
        answers: ["7", "2", "6", "5"],
        correctAnswer: "5"
    }, {
        question: "x(4 + 5) = 3 * 4 + 3 * 5",
        answers: ["8", "3", "6", "12"],
        correctAnswer: "3"
    }, {
        question: "(x + 5)x = (8 - 4) + 10",
        answers: ["9", "13", "2", "5"],
        correctAnswer: "2",
    }, {
        question: "6 * x - 9 = 11 * 3",
        answers: ["11", "7", "3", "9"],
        correctAnswer: "7"
    }, {
        question: "(9 - 3 * 1) * 4 = x",
        answers: ["4", "24", "14", "1"],
        correctAnswer: "24"
    }];

var game = {
    questions: questions,
    currentQuestion:0,
    counter:30,
    correct:0,
    incorrect:0,
    unanswered:0,
    countdown: function(){
        game.counter--;
        $('#counter').html(game.counter);
        if(game.counter <= 0){
            console.log("TIME UP!");
            game.timeUp();
        }

    },
    loadQuestion: function(){
        timer = setInterval(game.countdown, 1000);

        $('#subwrapper').html("<h2 id='counter'>30</h2>")
        $('#subwrapper').append('<h2>' + questions[game.currentQuestion].question + '</h2>');
                                    // or
        // $('#subwrapper').html('<h2>' + questions[game.currentQuestion].question + '</h2>');

            for(var i =3; i<questions[game.currentQuestion].answers.length;i++){
                $('#subwrapper').append('<input type="text" id="button-'+i+'"">'+'<button id="submitAnswer">'+"Submit Answer"+'</button>');
            }

    },
    nextQuestion: function(){
        game.counter = 30;
        $('#counter').html(game.counter);
        game.currentQuestion++;
        game.loadQuestion();


    },
    timeUp: function(){
        clearInterval(timer);
        game.unanswered++;
        $('#subwrapper').html('<h2>OUT OF TIME!</h2>');
        $('#subwrapper').append('<h3>The Correct Answer Was: '+questions[game.currentQuestion].correctAnswer+ '</h3>');
            if(game.currentQuestion==questions.length-1){
                    setTimeout(game.results,3*1000);
                } else {
                    setTimeout(game.nextQuestion,3*1000);
                }
    },
    results: function(){
        clearInterval(timer);
        $('#subwrapper').html("<h2>ALL DONE!</h2>");
        $('#subwrapper').append("Correct: "+game.correct);
        $('#subwrapper').append("<br>Incorrect: "+game.incorrect);
        $('#subwrapper').append("<br>Unanswered: "+game.unanswered);
        $('#subwrapper').append("<br><button id='reset'>RESET</button>")

    },
    clicked: function(e){
        clearInterval(timer);
        if(numberAnswer==questions[game.currentQuestion].correctAnswer){
            game.answeredCorrectly();
        } else {
            game.answeredIncorrectly();
        }

    },
    answeredCorrectly: function(){
            console.log("YOU GOT IT!");
            clearInterval(timer);
            game.correct++;
            $('#subwrapper').html('<h2>YOU GOT IT RIGHT!</h2');
            if(game.currentQuestion==questions.length-1){
                setTimeout(game.results,3*1000);
            } else {
                setTimeout(game.nextQuestion,3*1000);
            }
    },
    answeredIncorrectly: function(){
            console.log("WRONG");
            clearInterval(timer);
            game.incorrect++;
            $('#subwrapper').html('<h2>YOU GOT IT WRONG!</h2');
            $('#subwrapper').append('<h3>The Correct Answer Was: '+questions[game.currentQuestion].correctAnswer+ '</h3>');
            if(game.currentQuestion==questions.length-1){
                setTimeout(game.results,3*1000);
            } else {
                setTimeout(game.nextQuestion,3*1000);
            }
    },
    reset: function(){
        game.currentQuestion =0;
        game.counter = 30;
        game.correct = 0;
        game.incorrect = 0;
        game.unanswered = 0;
        game.loadQuestion();
    }
}

	</script>
    
</body>
</html>